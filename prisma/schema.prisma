// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Admin users (4-5 predefined accounts)
model Admin {
  id           String   @id @default(uuid())
  email        String   @unique
  passwordHash String   @map("password_hash")
  name         String
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  @@map("admins")
}

// Categories enum
enum Category {
  WEB_APP
  AI_TOOL
  MOBILE_APP
  SAAS
  EXPERIMENT
}

// Projects (portfolio items)
model Project {
  id             String   @id @default(uuid())
  name           String
  tagline        String
  description    String   @db.Text
  problem        String?  @db.Text
  solution       String?  @db.Text
  targetAudience String?  @map("target_audience") @db.Text
  techStack      String[] @map("tech_stack")
  features       String[] @default([])
  category       Category
  githubUrl      String?  @map("github_url")
  liveUrl        String?  @map("live_url")
  images         String[] @default([])
  videoUrl       String?  @map("video_url")
  isFeatured     Boolean  @default(false) @map("is_featured")
  order          Int      @default(0)
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")

  // Relations
  analytics Analytics[]
  leads     Lead[]

  @@index([category])
  @@index([isFeatured])
  @@index([createdAt])
  @@map("projects")
}

// Analytics events enum
enum EventType {
  VIEW
  MODAL_OPEN
  GITHUB_CLICK
  LIVE_CLICK
  CONTACT_CLICK
}

// Analytics tracking
model Analytics {
  id         String    @id @default(uuid())
  projectId  String    @map("project_id")
  eventType  EventType @map("event_type")
  visitorIp  String?   @map("visitor_ip")
  userAgent  String?   @map("user_agent")
  createdAt  DateTime  @default(now()) @map("created_at")

  // Relations
  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId])
  @@index([eventType])
  @@index([createdAt])
  @@map("analytics")
}

// Lead status enum
enum LeadStatus {
  NEW
  CONTACTED
  CLOSED
}

// Contact form submissions (leads)
model Lead {
  id        String     @id @default(uuid())
  projectId String?    @map("project_id")
  name      String
  email     String
  message   String     @db.Text
  status    LeadStatus @default(NEW)
  createdAt DateTime   @default(now()) @map("created_at")
  updatedAt DateTime   @updatedAt @map("updated_at")

  // Relations
  project Project? @relation(fields: [projectId], references: [id], onDelete: SetNull)

  @@index([status])
  @@index([createdAt])
  @@map("leads")
}

// Company settings (single record)
model CompanySettings {
  id           String   @id @default(uuid())
  companyEmail String   @map("company_email")
  companyName  String?  @map("company_name")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  @@map("company_settings")
}

// Team members
model TeamMember {
  id          String   @id @default(uuid())
  name        String
  role        String
  bio         String?  @db.Text
  education   String?  @db.Text
  experience  String?  @db.Text
  skills      String[] @default([])
  photoUrl    String?  @map("photo_url")
  githubUrl   String?  @map("github_url")
  linkedinUrl String?  @map("linkedin_url")
  twitterUrl  String?  @map("twitter_url")
  order       Int      @default(0)
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@index([order])
  @@index([isActive])
  @@map("team_members")
}